<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Accident Report Details</title>
    <style>
        /* Add to your existing report.html styles */
        .status-control {
            margin: 20px 0;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 5px;
        }
        .status-select {
            padding: 8px 12px;
            border-radius: 4px;
            border: 1px solid #ddd;
            font-family: inherit;
        }
        .status-new {
            background-color: #e3f2fd;
            color: #1976d2;
        }
        .status-reviewed {
            background-color: #e8f5e9;
            color: #388e3c;
        }
        /* OR for checkbox version */
        .status-checkbox {
            margin-left: 10px;
            transform: scale(1.3);
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Your existing report details here -->
        
        <!-- Add this status control section -->
        <div class="status-control">
            <label for="reportStatus">Status:</label>
            
            <!-- Dropdown Version -->
            <select id="reportStatus" class="status-select">
                <option value="new">New</option>
                <option value="reviewed">Reviewed</option>
            </select>
            
            <!-- OR Checkbox Version (choose one) -->
            <!--
            <input type="checkbox" id="reportReviewed" class="status-checkbox">
            <label for="reportReviewed">Mark as Reviewed</label>
            -->
        </div>
        
        <!-- Rest of your report template -->
    </div>

    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-firestore-compat.js"></script>
    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyDcjqTdo23GdBhAbfyq6Mchlbs0ad5TO7U",
            authDomain: "accident-report-9b7ee.firebaseapp.com",
            projectId: "accident-report-9b7ee",
            storageBucket: "accident-report-9b7ee.appspot.com",
            messagingSenderId: "644874177194",
            appId: "1:644874177194:web:647c19e7993b2194165ed3"
        };
        
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        
        // Get report ID from URL
        const urlParams = new URLSearchParams(window.location.search);
        const reportId = urlParams.get('id');
        
        // Load report data
        db.collection('reports').doc(reportId).get().then((doc) => {
            if (doc.exists) {
                const report = doc.data();
                
                // Set current status in the control
                const statusControl = document.getElementById('reportStatus');
                if (statusControl) {
                    statusControl.value = report.status || 'new';
                    statusControl.classList.add(`status-${report.status || 'new'}`);
                    
                    // Handle status changes
                    statusControl.addEventListener('change', (e) => {
                        const newStatus = e.target.value;
                        db.collection('reports').doc(reportId).update({
                            status: newStatus,
                            reviewedAt: newStatus === 'reviewed' ? firebase.firestore.FieldValue.serverTimestamp() : null
                        }).then(() => {
                            e.target.className = `status-select status-${newStatus}`;
                        });
                    });
                }
                
                // OR for checkbox version
                const checkbox = document.getElementById('reportReviewed');
                if (checkbox) {
                    checkbox.checked = report.status === 'reviewed';
                    checkbox.addEventListener('change', (e) => {
                        const newStatus = e.target.checked ? 'reviewed' : 'new';
                        db.collection('reports').doc(reportId).update({
                            status: newStatus,
                            reviewedAt: newStatus === 'reviewed' ? firebase.firestore.FieldValue.serverTimestamp() : null
                        });
                    });
                }
                
                // Populate other report fields...
                
            } else {
                console.log("No such document!");
            }
        });
    </script>
</body>
</html>
